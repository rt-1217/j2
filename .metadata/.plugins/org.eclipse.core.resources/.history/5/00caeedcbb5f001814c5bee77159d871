package com.internousdev.ecsite.action;

import java.util.Map;

import org.apache.struts2.interceptor.SessionAware;

import com.internousdev.ecsite.dao.UserCreateConfirmDAO;
import com.internousdev.ecsite.dto.LoginDTO;
import com.opensymphony.xwork2.ActionSupport;

public class UserUpdateAction extends ActionSupport implements SessionAware {

	private String loginUserId;
	private String checkLoginId;
	private String loginPassword;
	private String checkPassword;
	private String userName;
	private String userAddress;
	private String sex;
	private String tell;
	private Map<String,Object> session;
	private LoginDTO loginDTO= new LoginDTO();
	private UserCreateConfirmDAO userCreateConfirmDAO = new UserCreateConfirmDAO();

	public String execute(){
		String result =SUCCESS;

		boolean dateCheck = false;

		if(!(loginUserId.length() == 0)&& !(loginPassword.length() == 0)&& !(userName.length()==0)
				&& !(userAddress.length() ==0) && !(tell.length() ==0 )){
			if(loginUserId.equals(checkLoginId) && loginPassword.equals(checkPassword)){

				String defaultLoginId = ((LoginDTO) session.get("loginUser")).getLoginId();
				String defaultPassword = ((LoginDTO) session.get("loginUser")).getLoginPassword();
				session.put("dafaultLoginId", defaultLoginId);

				if(defaultLoginId.equals(loginUserId) || defaultPassword.equals(loginPassword)){

					//パスワードを変更する場合
					if(defaultLoginId.equals(loginUserId)){
						dateCheck=true;

					}else{
						//IDを変更する場合
						dateCheck=userCreateConfirmDAO.getUserInfo(loginUserId, loginPassword);
					}
				}else{
					//パスワードとIDの両方を変更する場合
					dateCheck = userCreateConfirmDAO.getUserInfo(loginUserId, loginPassword);
				}
			}
		}
	}

}
